spring:
  application:
    name: Imps-backend
  datasource:
    url: jdbc:postgresql://localhost:5432/imps_db
    username: postgres
    password: root

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    open-in-view: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true

server:
  port: 8081

# ===========================================
# ROUTING CONFIGURATION (dynamic - no hardcoding)
# ===========================================
# All URLs/hosts/ports must come from here. Change only this file for different environments.
# REST (current):
#   NPCI → IMPS:  {server.port}/imps/{reqpay|...}/{txn_id}
#   IMPS → Switch: routing.switch.base-url
#   Switch → IMPS: {server.port}/switch/{resppay|...}/{txn_id}
#   IMPS → NPCI:   routing.npci.base-url
routing:
  npci:
    base-url: http://localhost:8083
    endpoints:
      ack: /npci/ack

  switch:
    base-url: http://localhost:8082

# ===========================================
# SOCKET-BASED IMPS (future) - all from config
# ===========================================
# When switching to TCP sockets: no hardcoded host/port in code.
# Server: IMPS listens for NPCI/Switch inbound (bind 0.0.0.0 in UAT/prod, not localhost).
# Client: IMPS connects to NPCI/Switch (use server IP or hostname in UAT/prod).
# Persistent connections; ACK and responses on same socket; multi-threading per plan.
socket:
  enabled: false
  server:
    bind-host: 0.0.0.0
    npci:
      port: 9083
    switch:
      port: 9082
  client:
    npci:
      host: localhost
      port: 8083
    switch:
      host: localhost
      port: 8082
  threading:
    acceptor-threads: 1
    io-pool-size: 10
    processing-pool-size: 20
  framing:
    length-prefix-bytes: 4
    encoding: UTF-8

# ===========================================
# API VERSION
# ===========================================
imps:
  api:
    version: "2.1"
  org-id: "BANK01"

  # Heartbeat Rule: System must generate heartbeat messages every 3 minutes.
  # If no response is received, NPCI may mark the bank BIN down and block outward traffic.
  heartbeat:
    enabled: true
    interval-ms: 180000   # 3 minutes
    initial-delay-ms: 15000   # First heartbeat 15 seconds after startup
